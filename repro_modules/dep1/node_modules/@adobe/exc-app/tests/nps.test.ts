/*************************************************************************
 * Copyright 2020 Adobe
 * All Rights Reserved.
 *
 * NOTICE: Adobe permits you to use, modify, and distribute this file in
 * accordance with the terms of the Adobe license agreement accompanying
 * it. If you have received this file from a source other than Adobe,
 * then your use, modification, or distribution of it requires the prior
 * written permission of Adobe.
 **************************************************************************/
import Global, {Modules} from '../src/Global';
import nps from '../nps';

describe('nps/index.js', () => {
  beforeEach(() => {
    (Global['exc-module-runtime'] as Modules) = {
      nps: {
        config: {
          enabled: true,
          sampling: 100,
          showToAdobeUsers: true
        },
        triggerNps: () => {}
      }
    } as Modules;
  });
  it('correctly sets up the connection with module-runtime for triggerNps function', () => {
    const triggerNpsSpy = jest.spyOn(Global['exc-module-runtime'].nps, 'triggerNps');
    nps.triggerNps();
    expect(triggerNpsSpy).toBeCalledTimes(1);
  });

  it('correctly sets up the connection with module-runtime for config object', () => {
    nps.config = {enabled: true, sampling: 55};
    expect(Global['exc-module-runtime'].nps.config).toStrictEqual({enabled: true, sampling: 55});
  });
});
